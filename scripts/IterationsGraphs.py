import matplotlib.pyplot as plt
import numpy as np
import os

# Create a folder named 'graphs' to save the plot
if not os.path.exists('graphs'):
    os.makedirs('graphs')

#threads = 2


jacobi = [ 0.5,0.25,0.125,0.125,0.09375,0.078125,0.0703125,0.0546875,0.0546875,0.046875,0.0439453,0.0402832,0.0362549,0.0349121,0.0305481,0.0305481,0.027771,0.0269775,0.0252914,0.0240269,0.0231028,0.0215626,0.0211775,0.0194833,0.0194833,0.0182656,0.0179889,0.0171423,0.0166662,0.0161106,0.015491,0.0151649,0.0144427,0.0142983,0.0135039,0.0135039,0.0128901,0.012775,0.0123122,0.0121052,0.011769,0.0114888,0.011259,0.0109204,0.0107804,0.0103954,0.0103312,0.00990951,0.00990951,0.00956781,0.00951344,0.00924163,0.00914118,0.00893055,0.00879101,0.00863403,0.00846135,0.00835146,0.0081507,0.00808221,0.00785771,0.00782563,0.00758108,0.00758108,0.00737619,0.00734793,0.00717873,0.00712556,0.00698853,0.00691338,0.00680536,0.00671084,0.006629,0.0065174,0.00645921,0.00633256,0.00629574,0.00615584,0.00613835,0.00598678,0.00598678,0.00585664,0.00584081,0.00573034,0.00570018,0.00560782,0.00556468,0.00548897,0.00543408,0.0053737,0.00530817,0.00526191,0.00518674,0.00515349,0.0050696,0.00504834,0.00495656,0.00494636,0.00484743,0.00484743,0.00476087,0.00475146,0.00467644,0.00465835,0.00459409,0.00456799,0.00451379,0.0044803,0.00443549,0.00439517,0.00435914,0.00431252,0.0042847,0.00423226,0.00421211,0.00415431,0.00414133,0.00407858,0.00407231,0.004005,0.004005,0.00394522,0.00393935,0.00388668,0.00387532,0.00382937,0.00381286,0.00377325,0.00375193,0.0037183,0.00369248,0.00366451,0.00363447,0.00361184,0.00357786,0.00356028,0.0035226,0.00350979,0.00346866,0.00346036,0.003416,0.00341197,0.00336458,0.00336458,0.00332199,0.00331817,0.00328015,0.00327273,0.00323906,0.00322823,0.0031987,0.00318464,0.00315906,0.00314195,0.00312013,0.00310013,0.00308189,0.00305916,0.00304434,0.00301902,0.00300746,0.00297969,0.00297123,0.00294116,0.00293565,0.00290339,0.0029007,0.00286637,0.00286637,0.00283522,0.00283265,0.00280454,0.00279953,0.00277433,0.00276699,0.00274458,0.00273502,0.0027153,0.00270361,0.00268646,0.00267276,0.00265807,0.00264243,0.00263012,0.00261264,0.00260259,0.00258336,0.00257549,0.00255458,0.00254881,0.0025263,0.00252253,0.00249851,0.00249666,0.00247118,0.00247118,0.00244787,0.0024461,0.00242487,0.00242139,0.00240217,0.00239706,0.00237978,0.0023731,0.00235769,0.00234951,0.0023359,0.00232627,0.0023144,0.00230338,0.00229319,0.00228083,0.00227226,0.00225862,0.00225161,0.00223675,0.00223124,0.0022152,0.00221114,0.00219397,0.00219131,0.00217305,0.00217174,0.00215244,0.00215244,0.00213465,0.00213339,0.00211707,0.0021146,0.0020997,0.00209605,0.00208253,0.00207775,0.00206556,0.0020597,0.0020488,0.00204188,0.00203223,0.00202429,0.00201586,0.00200694,0.00199968,0.00198981,0.00198369,0.00197291,0.00196789,0.00195622,0.00195227,0.00193976,0.00193684,0.0019235,0.00192159,0.00190746,0.00190652,0.00189162,0.00189162,0.00187782,0.0018769,0.00186415,0.00186236,0.00185063,0.00184798,0.00183725,0.00183377,0.00182401,0.00181972,0.00181091,0.00180584,0.00179794,0.00179211,0.00178511,0.00177855,0.00177242,0.00176514,0.00175986,0.00175189,0.00174742,0.00173879,0.00173512,0.00172584,0.00172295,0.00171304,0.0017109,0.00170038,0.00169898,0.00168787,0.00168718,0.0016755,0.0016755,0.00166462,0.00166395,0.00165384,0.00165251,0.00164316,0.00164119,0.00163259,0.00162999,0.00162211,0.00161891,0.00161172,0.00160794,0.00160144,0.00159708,0.00159125,0.00158633,0.00158115,0.0015757,0.00157115,0.00156517,0.00156124,0.00155475,0.00155142,0.00154444,0.0015417,0.00153423,0.00153207,0.00152412,0.00152252,0.00151412,0.00151306,0.00150422,0.0015037,0.00149441,0.00149441,0.00148572,0.00148522,0.00147711,0.00147611,0.00146857,0.00146708,0.00146009,0.00145813,0.00145169,0.00144927,0.00144336,0.00144049,0.0014351,0.00143179,0.00142691,0.00142317,0.00141878,0.00141463,0.00141072,0.00140617,0.00140274,0.00139778,0.00139481,0.00138947,0.00138696,0.00138124,0.00137917,0.00137308,0.00137144,0.001365,0.00136378,0.00135698,0.00135618,0.00134904,0.00134865,0.00134118,0.00134118,0.00133415,0.00133377,0.00132719,0.00132642,0.00132027,0.00131913,0.0013134,0.0013119,0.00130659,0.00130474,0.00129983,0.00129763,0.00129312,0.00129058,0.00128646,0.00128359,0.00127985,0.00127665,0.00127329,0.00126978,0.00126678,0.00126296,0.00126032,0.00125619,0.00125391,0.00124948,0.00124755,0.00124283,0.00124123,0.00123623,0.00123496,0.00122968,0.00122874,0.00122319,0.00122257,0.00121675,0.00121644,0.00121036,0.00121036,0.00120462,0.00120432,0.00119892,0.00119833,0.00119327,0.00119238,0.00118765,0.00118648,0.00118207,0.00118062,0.00117652,0.00117481,0.00117102,0.00116904,0.00116555,0.00116331,0.00116012,0.00115762,0.00115473,0.00115198,0.00114937,0.00114638,0.00114405,0.00114082,0.00113877,0.0011353,0.00113352,0.00112982,0.00112831,0.00112438,0.00112314,0.00111898,0.001118,0.00111363,0.00111289,0.00110831,0.00110782,0.00110303,0.00110279,0.00109779,0.00109779,0.00109306,0.00109282,0.00108835,0.00108789,0.00108368,0.00108299,0.00107904,0.00107812,0.00107442,0.00107329,0.00106983,0.00106848,0.00106528,0.00106372,0.00106075,0.00105898,0.00105625,0.00105427,0.00105177,0.0010496,0.00104733,0.00104496,0.00104291,0.00104035,0.00103852,0.00103577,0.00103416,0.00103122,0.00102982,0.0010267,0.00102552,0.00102222,0.00102124,0.00101776,0.00101698,0.00101333,0.00101275,0.00100893,0.00100855,0.00100456,0.00100437,0.00100022,0.00100022,0.000996285,0.000996098,0.00099237,0.000991999,0.000988477,0.000987926,0.000984606,0.000983877,0.000980757,0.000979853,0.00097693,0.000975855,0.000973125,0.000971881,0.000969342,0.000967931,0.00096558,0.000964006,0.00096184,0.000960105,0.000958121,0.000956227,0.000954423,0.000952374,0.000950747,0.000948544,0.000947091,0.000944738,0.000943456,0.000940955,0.000939842,0.000937195,0.000936248,0.000933458,0.000932675,0.000929744,0.000929122,0.000926052,0.000925589,0.000922383,0.000922077,0.000918736,0.000918584,0.000915111,0.000915111,0.000911807,0.000911658,0.000908521,0.000908224,0.000905252,0.00090481,0.000902,0.000901415,0.000898765,0.000898039,0.000895547,0.000894683,0.000892346,0.000891345,0.000889162,0.000888026,0.000885994,0.000884726,0.000882843,0.000881444,0.000879708,0.000878181,0.00087659,0.000874936,0.000873488,0.000871709,0.000870402,0.000868501,0.000867333,0.00086531,0.00086428,0.000862138,0.000861242,0.000858983,0.00085822,0.000855845,0.000855215,0.000852725,0.000852224,0.000849623,0.00084925,0.000846538,0.000846291,0.00084347,0.000843347,0.000840419,0.000840419,0.000837627,0.000837506,0.000834848,0.000834608,0.000832083,0.000831725,0.000829331,0.000828857,0.000826593,0.000826004,0.000823867,0.000823166,0.000821155,0.000820343,0.000818456,0.000817534,0.00081577,0.00081474,0.000813097,0.00081196,0.000810437,0.000809194,0.00080779,0.000806443,0.000805155,0.000803706,0.000802533,0.000800983,0.000799924,0.000798275,0.000797327,0.00079558,0.000794743,0.000792899,0.000792171,0.000790231,0.000789612,0.000787578,0.000787065,0.000784938,0.00078453,0.000782312,0.000782008,0.000779699,0.000779497,0.000777099,0.000776999,0.000774513,0.000774513,0.000772137,0.000772038,0.000769772,0.000769576,0.000767417,0.000767125,0.000765073,0.000764686,0.000762739,0.000762258,0.000760416,0.000759842,0.000758103,0.000757438,0.000755801,0.000755045,0.000753508,0.000752664,0.000751226,0.000750294,0.000748954,0.000747936,0.000746693,0.000745588,0.000744441,0.000743252,0.000742199,0.000740927,0.000739968,0.000738613,0.000737746,0.000736309,0.000735534,0.000734017,0.000733332,0.000731736,0.00073114,0.000729465,0.000728958,0.000727206,0.000726785,0.000724957,0.000724622,0.000722718,0.000722469,0.00072049,0.000720325,0.000718273,0.000718191,0.000716066,0.000716066,0.000714032,0.000713951,0.000712006,0.000711845,0.000709988,0.000709748,0.000707979,0.000707661,0.000705979,0.000705582,0.000703986,0.000703513,0.000702002,0.000701454,0.000700026,0.000699403,0.000698058,0.000697361,0.000696098,0.000695329,0.000694146,0.000693305,0.000692203,0.00069129,0.000690267,0.000689284,0.00068834,0.000687287,0.00068642,0.000685299,0.000684509,0.000683319,0.000682605,0.000681348,0.000680709,0.000679386,0.000678821,0.000677433,0.000676941,0.000675487,0.000675068,0.000673551,0.000673204,0.000671623,0.000671347,0.000669703,0.000669497,0.000667792,0.000667655,0.000665889,0.000665821,0.000663995,0.000663995,0.000662243,0.000662175,0.000660497,0.000660364,0.000658759,0.000658559,0.000657027,0.000656763,0.000655302,0.000654973,0.000653583,0.000653191,0.000651871,0.000651416,0.000650166,0.000649649,0.000648467,0.000647888,0.000646775,0.000646135,0.00064509,0.000644389,0.00064341,0.000642651,0.000641738,0.000640919,0.000640071,0.000639194,0.000638411,0.000637477,0.000636758,0.000635766,0.000635111,0.000634063,0.00063347,0.000632366,0.000631835,0.000630676,0.000630207,0.000628994,0.000628585,0.000627318,0.000626969,0.000625648,0.000625359,0.000623986,0.000623756,0.00062233,0.000622159,0.000620681,0.000620568,0.000619039,0.000618982,0.000617403,0.000617403,0.000615886,0.00061583,0.000614375,0.000614263,0.000612869,0.000612702,0.000611368,0.000611147,0.000609873,0.000609598,0.000608383,0.000608055,0.000606898,0.000606518,0.000605419,0.000604986,0.000603945,0.000603461,0.000602476,0.000601941,0.000601013,0.000600427,0.000599555,0.000598919,0.000598102,0.000597416,0.000596654,0.000595919,0.000595212,0.000594428,0.000593774,0.000592943,0.000592342,0.000591463,0.000590915,0.000589989,0.000589493,0.00058852,0.000588076,0.000587057,0.000586664,0.000585599,0.000585257,0.000584147,0.000583856,0.000582701,0.000582459,0.00058126,0.000581067,0.000579824,0.00057968,0.000578394,0.000578299,0.000576969,0.000576922,0.00057555,0.00057555,0.00057423,0.000574183,0.000572914,0.00057282,0.000571603,0.000571463,0.000570296,0.00057011,0.000568993,0.000568763,0.000567695,0.00056742,0.000566402,0.000566082,0.000565112,0.000564748,0.000563827,0.00056342,0.000562546,0.000562096,0.00056127,0.000560776,0.000559998,0.000559462,0.00055873,0.000558152,0.000557466,0.000556847,0.000556207,0.000555546,0.000554951,0.00055425,0.0005537,0.000552959,0.000552454,0.000551672,0.000551211,0.000550389,0.000549972,0.000549112,0.000548738,0.000547838,0.000547508,0.00054657,0.000546281,0.000545305,0.000545059,0.000544045,0.000543841,0.00054279,0.000542628,0.000541539,0.000541418,0.000540292,0.000540212,0.00053905,0.00053901,0.000537812,0.000537812,0.000536658,0.000536618,0.000535508,0.000535429,0.000534361,0.000534243,0.000533218,0.000533061,0.000532078,0.000531883,0.000530942,0.000530709,0.000529809,0.000529539,0.00052868,0.000528372,0.000527555,0.00052721,0.000526433,0.000526051,0.000525315,0.000524897,0.0005242,0.000523746,0.000523088,0.000522599,0.00052198,0.000521455,0.000520876,0.000520316,0.000519775,0.00051918,0.000518678,0.000518048,0.000517583,0.00051692,0.000516493,0.000515796,0.000515406,0.000514675,0.000514322,0.000513558,0.000513241,0.000512444,0.000512164,0.000511335,0.000511091,0.000510229,0.00051002,0.000509126,0.000508953,0.000508027,0.00050789,0.000506932,0.000506829,0.000505841,0.000505772,0.000504753,0.000504719,0.000503668,0.000503668,0.000502655,0.000502621,0.000501645,0.000501577,0.000500637,0.000500537,0.000499633,0.000499499,0.000498631,0.000498465,0.000497633,0.000497434,0.000496637,0.000496407,0.000495644,0.000495382,0.000494654,0.000494361,0.000493668,0.000493343,0.000492684,0.000492328,0.000491703,0.000491316,0.000490724,0.000490307,0.000489749,0.000489302,0.000488777,0.000488299,0.000487807,0.0004873,0.00048684,0.000486304,0.000485877,0.000485311,0.000484916,0.000484321,0.000483957]
jacobi = jacobi[:1000]
ssor10 = [0.373677,1.53101,3.62324,6.71153,10.5258,15.151,20.6353,26.8876]
gauss_sidel = [0.156668,0.69557,1.70365,3.12661,4.96193,7.21092,9.8265,12.9168]
gauss_elimination = [0.00811063,0.0642115,0.245409,0.7746,1.71589,3.13128,5.42308,8.46707]


size = np.arange(1, 1000 + 1)
#Set the figure size and font size
plt.figure(figsize=(6, 4))
plt.rcParams.update({'font.size': 10})

plt.yscale('log', base=10)

# # Set y-axis ticks from 1e-1 to 1e-17 with even spacing
# y_ticks = np.logspace(-1, -17, num=17, base=10)

# # Create a linearly spaced array for the y-axis scale
# y_scale = np.linspace(min(jacobi), max(jacobi), num=100)

# # Set y-axis ticks and labels
# plt.yticks(y_ticks, ['{:.0e}'.format(val) for val in y_ticks])


# Plot the data with a solid line and marker
#plt.plot(size, ssor10, ':^', label="DENSE SSOR w = 0.5", color='orange', markersize=8, linewidth=2)
plt.plot(size, jacobi, '-o', label="DENSE Jacobi Method", color='red', markersize=10, linewidth=3)
# plt.plot(size, gauss_sidel, '-.D', label="DENSE Gauss Sidel", color='blue', markersize=8, linewidth=2)
# plt.plot(size, gauss_elimination, '--s', label="DENSE Gauss Eliminaton", color='green', markersize=8, linewidth=2)
#plt.plot(size, ssor15, ':*', label="SSOR w = 1.5", color='purple', markersize=8, linewidth=2)
# plt.plot(size, rayonVectorNoPivot, '-.+', label="Rayon+Vector+NoPivot", color='yellow', markersize=8, linewidth=2)

# Add axis labels and title
plt.xlabel('Iterations')
plt.ylabel('Residual')
plt.suptitle("Iterations Vs. Error")
plt.title("A is Tridiagonal, B is First Canonical Basis Vector")

# Add gridlines and legend
plt.grid(False)
plt.legend(loc='upper left')

# Save the plot to the 'graphs' folder with the name 'plot.png'
plt.savefig('graphs/IterationsSparseThree.png',dpi=600)